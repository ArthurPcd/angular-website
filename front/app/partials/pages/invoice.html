<div class="invoice-panel container mt-4" ng-controller="invoiceCtrl">
    <h2>Générateur de Facture</h2>

    <div class="mb-3 w-50">
        <label>Nom du Client:</label>
        <input class="form-control" ng-model="invoiceData.clientName" placeholder="Nom du client" type="text"/>
        <label>Numéro de Facture:</label>
        <input class="form-control" ng-model="invoiceData.invoiceNumber" placeholder="Numéro de facture" type="number"/>
        <label>Date:</label>
        <input class="form-control" ng-model="invoiceData.invoiceDate" type="date"/>
        <label>SIRET:</label>
        <input class="form-control" ng-model="invoiceData.companySIRET" placeholder="Se compose de 14 chiffres"
               type="number"/>
        <label>Numéro de TVA:</label>
        <input class="form-control" ng-model="invoiceData.companyVATNumber"
               placeholder="Se compose de FR + clé de contrôle + numéro SIREN" type="text"/>
        <label>Adresse de l'entreprise:</label>
        <input class="form-control" ng-model="invoiceData.companyAddress" placeholder="Adresse de l'entreprise"
               type="text"/>
        <label>Contact de l'entreprise:</label>
        <input class="form-control" ng-model="invoiceData.companyContact"
               placeholder="E-mail ou numéro de téléphone de l'entreprise." type="text"/>
    </div>

    <h3>Articles:</h3>
    <table class="table table-bordered">
        <thead>
        <tr>
            <th>Article</th>
            <th>Quantité</th>
            <th>Prix Unitaire</th>
            <th>Total</th>
            <th><i class="fa fa-cog"></i></th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="item in invoiceData.items">
            <td>
                <select class="form-control" ng-change="updateItemDetails(item)"
                        ng-model="item.productId"
                        ng-options="product.id as product.name + ' ' +  product.description for product in products">
                    <option value="">Sélectionner un produit</option>
                </select>
            </td>
            <td><input class="form-control" min="1" ng-change="updateItemTotal(item)" ng-model="item.quantity"
                       type="number"/></td>
            <td>{{item.price | currency:"€"}}</td>
            <td>{{item.total | currency:"€"}}</td>
            <td><i class="fa fa-trash" ng-click="removeItem($index)"></i></td>
        </tr>
        </tbody>
    </table>
    <button class="btn btn-primary" ng-click="addInvoiceItem()"><i class="fa fa-plus"></i> Ajouter un Article</button>

    <div class="mt-4">
        <h3>Total Facture: {{calculateTotal() | currency:"€"}}</h3>
        <h4 class="small-text"> Veuillez penser à générer la facture avant de l'imprimer ou de la télécharger.</h4>
        <button class="btn btn-success" ng-class="{'vibrate-red': isPriceNaN()}" ng-click="generateInvoice()"><i
                class="fa fa-file p-lg-1"></i> Générer
        </button>
        <button class="btn btn-info" ng-click="printInvoice()" ng-show="invoiceGenerated"><i
                class="fa fa-print p-lg-1"></i> Imprimer - Télécharger
        </button>
    </div>

    <div id="generated-invoice" ng-bind-html="generatedInvoiceHtml"></div>
</div>
